\documentclass[a4paper]{article}
\usepackage{amsmath}
\def\npart {IB}
\def\nterm {Lent}
\def\nyear {2018}
\def\nlecturer {Dr. Saxton}
\def\ncourse {Numerical Analysis Example Sheet 1}

\input{header}

\newtheorem*{soln}{Solution}

\renewcommand{\thesection}{}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\makeatletter
\def\@seccntformat#1{\csname #1ignore\expandafter\endcsname\csname the#1\endcsname\quad}
\let\sectionignore\@gobbletwo
\let\latex@numberline\numberline
\def\numberline#1{\if\relax#1\relax\else\latex@numberline{#1}\fi}
\makeatother


\begin{document}
	
\maketitle

\section{QUESTION 1}

We seek some polynomial interpolant $ p \in \mathbb{P}_{3}[x] $. Using the Lagrange formula we have that

\[ p(x) = \sum_{k=0}^{3} f(k) l_{k}  \]

where 

\[ l_{k} = \prod_{i=0, i \neq k}^{3} \frac{x - i}{k - i}  \] 

that is,

\[ p(x) = f(0) \frac{(x-1)(x-2)(x-3)}{-6} + f(1) \frac{x(x-2)(x-3)}{2} + f(2) \frac{x(x-1)(x-3)}{-2} + f(3) \frac{x(x-1)(x-2)}{6}  \]

\begin{enumerate}
	\item The approximant $ p(6) $
	
	We have
	
	\begin{align*}
	p(6) & = f(0) \frac{5 \cdot 4 \cdot 3}{-6} + f(1) \frac{6\cdot 4 \cdot 3}{2} + f(2) \frac{6 \cdot 5 \cdot 3}{-2} + f(3) \frac{6 \cdot 5 \cdot 4}{6} \\
	& = -10 f(0) + 36 f(1)+ -45 f(2) + 20 f(3) 
	\end{align*}
	
	\item The approximant $ p'(0) $
	
	Taking the derivative of each term individually, we then plug in $ x=0 $. We deduce that
	
	\begin{align*}
	p'(0) & = -\frac{11}{6} f(0) + 3f(1) - \frac{3}{2}  f(2) + \frac{1}{3} f(3) 
	\end{align*}
	
	\item The approximant $ \int_{0}^{3} p(x) \; \d x $
	
	Expanding each term and integrating (I can't see a shorter way) we have that

	\[ p(x) = f(0) \frac{x^{3} - 6x^{2} + 11 x - 6}{-6} + f(1) \frac{x^{3}  - 5 x^{2} + 6x}{2} + f(2) \frac{x^{3} - 4 x^{2} + 3x}{-2} + f(3) \frac{x^{3} - 3x^{2} + 2x}{6}  \]
	
	(\emph{I've cheated a bit with Mathematica here})
	
	\begin{align*}
	\int_{0}^{3} p(x) \; \d x & = \frac{3}{8} f(0) + \frac{9}{8} f(1) +  \frac{9}{8} f(2) + \frac{3}{8} f(3)  
	\end{align*}
	
	We can check this by supposing $ f(x) = x, $ so that $ f(k)  = k  $ for each $ k $. Indeed, $ p(6) = 6, p'(0) = 1 $, and $ \int_{0}^{3} p(x) \; \d x =  9/2 $, 
	
\end{enumerate}



\section{QUESTION 2}

The formula is true when $ x = 0,1 $ since both sides of the equation vanish. Let $ x \in (0,1) $ be any other point and define (for $ x $ fixed).

\[ \phi(t): = [f(t) - p(t)] \prod_{i=0}^{3} (x - x_{i}) - [f(x) - p(x)]\prod_{i=0}^{3} (t - x_{i}), \quad t \in (0,1)  \]

where $ x_{0} = x_{1} = 0, x_{2} = x_{3} = 1 $. Note $ \phi(0) = \phi(1) = 0 $, and also $ \phi(x) = 0 $. Hence, $ \phi $ has at least 3 zeroes. Applying Rolle's theorem, and using the condition that $ f'(0) = f'(1) = 0 $, we deduce that $ \phi'(t) $ has at least 4 zeroes: one at $ x_{0} = 0$, one at $ x_{2} = 1 $, and two more: one in the interval $ (0,x) $, and the other in $ (x,1) $.

Then $ \phi''(t) $ has at least 3 zeroes in $ (0,1) $, and... $ \phi^{(4)}(x) $ has at least one zero in $ (0,1) $; call it $ \xi $. Then

\[ 0 = \phi^{(4)}(\xi) = \left[  f^{(n+1)}(\xi) - p^{(n+1)}(\xi) \right] \prod_{i=0}^{3} (x - x_{i}) - \left[ f(x) - p(x) \right] \frac{\d^{4} }{\d t^{4}}\Big|_{t = \xi} \prod_{i=0}^{3} (t - x_{i})    \]

Since $ p^{(4)} \equiv 0 $, and $ \frac{\d^{4} }{\d t^{4}}\Big|_{t = \xi} \prod_{i=0}^{3} (t - x_{i}) = 4! $, we obtain 

\begin{align*}
f(x) - p(x) & = \frac{1}{4!} f^{(4)}(\xi) \prod_{i=0}^{3} (x - x_{i})  \\
& = \frac{1}{24} x^{2}(1-x)^{2} f^{(4)}(\xi) 
\end{align*}

\section{QUESTION 3}

%As $ a $ and $ b $ are arbitrary, we have two different cases to consider, $ a < b < c $ and $ a < c < b $. 
%
%\begin{enumerate}
%	\item $ a < b < c $:
%	
%	Here, we have
%	
%\end{enumerate}

%Nah fuck that, second attempt


%Using the Lagrange formula to interpolate the two points $ f(a),f(b) $, we have
%
%\[ p(x) = f(a)\left( \frac{x - b}{a - b} \right) + f(b)\left(   \frac{x - a}{b - a} \right)  \]
%
%We readily verify that $ p(a) = f(a)$, $ p(b) = f(b) $. Note that
%
%\[ p'(x) = \frac{f(a) - f(b)}{a - b} \]
%
%is a constant. 
%
%Next, consider the polynomial $ q(x) $ that interpolates $ f'(a),f'(b),f'(c) $, again found using Lagrange:
%
%\[ q(x) = f'(a) \left( \frac{x - b}{a - b} \right) \left( \frac{x - c}{a - c} \right) + f'(b) \left( \frac{x - a}{b - a} \right)\left( \frac{x - c}{b - c} \right)+ f'(c) \left( \frac{x - a}{c - a} \right)\left( \frac{x - b}{c - b} \right) \]
%
%Define 
%
%\[ r(x) = p(x) + \int_{x_{0}}^{x} q(t) \; \d t - x \frac{f(a) - f(b)}{a - b}  \]
%
%where $ x_{0} $ is chosen such that $ \int_{x_{0}}^{a} q(t) \; \d t = a  \frac{f(a) - f(b)}{a - b} $ and $ \int_{x_{0}}^{b} q(t) \; \d t = b \frac{f(a) - f(b)}{a - b}  $. Then $ r(a) = f(a), r(b) = f(b) $. We also have
%
%\[ r'(x) = q(x) \]
%
%So $ r'(a) = r'(b) = r'(c) $.
%
%Hence we have existence. 

Seeking a contradiction we suppose there exists some nonzero polynomial $ p \in \P_{4} [x] $ st. 

\[ p(a) = p(b) = p'(a) = p'(b) = p'(c) = 0 \qquad (*) \] 


Suppose that $ q_{1} \in \P_{4} [x] $ and $ q_{2} \in \P_{4} [x] $ both interpolate the data, then $ q_{1} - q_{2}  $ vanishes at these points. Hence, we have

\[ q_{1} = q_{2} + k p \]

for some $ k \in \R $, so the solution of this interpolation problem is not unique. 

To pick a value of $ c $ that satisfies $ (*) $, try

\[ p(x) = (x - a)(x - b) + (x - a)(x - b)(x - c) \]

Immediately we have $ p(a) = p(b) = 0 $. Now, 

\[ p'(x) =  (x- a) + (x - b)  (x - b)(x - c) +  (x - a)(x - c) +  (x - a)(x - b)   \]


\section{QUESTION 4}


By definition, $ f[x_{0},x_{1},\cdots,x_{n},x] $ is the coefficient of $ x^{n+1} $ in $ q  \in \P_{n+1}[x] $ that interpolates the $ n+2 $ points $ [x_{0},x_{1},\cdots,x_{n},x] $ with $ f $.

From the definition of the divided difference we have that

\[ f[x_{0},x_{1},\cdots,x_{n},x] = \frac{f[x_{1},x_{2},\cdots,x_{n+1},x] - f[x_{0},x_{1},\cdots,x_{n}]  }{x - x_{0}} \]

But also,

\[ f[x_{1},\cdots,x_{n},x] = \frac{f[x_{2},\cdots,x_{n+1},x] - f[x_{1},\cdots,x_{n}]  }{x - x_{1}} \]

When $ n = 0 $ the identity reads

\begin{align*}
f(x) - p(x) & = f[x_{0},x](x-x_{0}) \\
& = f(x) - f(x_{0})
\end{align*}

When $ n = 1$ the identity reads

\begin{align*}
f(x) - p(x) & = f[x_{0},x_{1},x](x-x_{0})(x-x_{1}) \\
& = \frac{f[x_{0},x_{1}] - f[x_{1},x]}{x - x_{0}}
\end{align*}

Nah fuck that, third attempt


 
 




\section{QUESTION 5}

The Newton divided difference table for Question 5 is shown below.

\begin{center}
	\begin{tabular}{ccccc}
		\toprule
		$x_i$ & $f_i$ & $f[*, *]$ & $f[*, *, *]$ & $f[*,*,*,*]$\\
		\midrule
		$0$ & $f[0] = 0$\\
		& & $f[0, 0.1] = 0.998$\\
		$0.1$ & $f[0.1] = 0.0998$ & & $f[0, 0.1, 0.4] $ \\
		& & $f[0.1, 0.4] = 0.9687 $ & $ = 0.0733 $ & $f[0,0.1,0.4,0.7] $ \\
		$0.4$ & $f[0.4] = 0.3894$ & & $f[0.1, 0.4, 0.7] $ & $ = - 0.389 $  \\
		& & $f[0.4, 0.7] = 0.8493$ & $ = -0.1990 $ \\
		$0.7$ & $f[0.7] = 0.6442$ & \\
		\bottomrule
	\end{tabular}
\end{center}

Using Newton's formula, the polynomial interpolating these points is given as

\begin{align*}
p(x) & = f[0] + f[0,0.1]x + f[0,0.1,0.4]x(x-0.1) + f[0,0.1,0.4,0.7]x(x-0.1)(x-0.4)  \\
& = 0.998 x + 0.0733(x^2 -0.1x) - 0.389(x^{3} -0.5x^{2}  + 0.04x)\\
& = 0.9751 x + 
\end{align*}



\section{QUESTION 6}




\section{QUESTION 7}
\section{QUESTION 8}
\section{QUESTION 9}
\section{QUESTION 10}
\section{QUESTION 11}
\section{QUESTION 12}



\end{document}